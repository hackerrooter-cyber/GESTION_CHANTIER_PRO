:root{
  --bg:#020617;
  --bg-card:#020617;
  --bg-elevated:#020617;
  --border-subtle:rgba(148,163,184,0.35);
  --accent:#0ea5e9;
  --accent-soft:rgba(56,189,248,0.15);
  --danger:#f97373;
  --danger-soft:rgba(248,113,113,0.14);
  --text-main:#e5e7eb;
  --text-muted:#9ca3af;
  --radius:10px;
  --radius-lg:14px;
  --pad:12px;
  --shadow-soft:0 18px 55px rgba(15,23,42,0.75);
  --shadow-chip:0 0 0 1px rgba(15,23,42,0.6);
  --table-border:rgba(148,163,184,0.25);
}

/* ThÃ¨me clair optionnel */
body.theme-light{
  --bg:#f3f4f6;
  --bg-card:#ffffff;
  --bg-elevated:#f9fafb;
  --border-subtle:#e5e7eb;
  --text-main:#0f172a;
  --text-muted:#6b7280;
  --shadow-soft:0 8px 25px rgba(15,23,42,0.12);
  --shadow-chip:0 0 0 1px rgba(148,163,184,0.4);
  --table-border:#e5e7eb;
}

/* Reset de base */
*,
*::before,
*::after{
  box-sizing:border-box;
}
html,body{
  margin:0;
  padding:0;
  height:100%;
}
body{
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
  background:radial-gradient(circle at 15% 20%,rgba(56,189,248,0.06),transparent 35%),
             radial-gradient(circle at 80% 0,rgba(56,189,248,0.08),transparent 45%),
             #020617;
  color:var(--text-main);
}

/* Layout global */
.app-shell{
  min-height:100vh;
  max-width:1200px;
  margin:0 auto;
  padding:16px;
  display:flex;
  flex-direction:column;
  gap:16px;
}

/* Header */
header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  position:sticky;
  top:0;
  z-index:10;
  padding:4px 0;
  background:linear-gradient(180deg,rgba(2,6,23,0.9),rgba(2,6,23,0.75));
}
.brand{
  display:flex;
  align-items:center;
  gap:12px;
}
.logo{
  width:38px;
  height:38px;
  border-radius:999px;
  display:flex;
  align-items:center;
  justify-content:center;
  background:radial-gradient(circle at 30% 0,#38bdf8,#0ea5e9 40%,#0369a1 100%);
  color:#e5f1ff;
  font-weight:700;
  font-size:20px;
  box-shadow:0 12px 30px rgba(15,23,42,0.65);
}
header h1{
  margin:0;
  font-size:18px;
  letter-spacing:0.02em;
}
.subtitle{
  font-size:12px;
  color:var(--text-muted);
}
.pill{
  display:inline-flex;
  align-items:center;
  gap:6px;
  border-radius:999px;
  padding:4px 10px;
  font-size:11px;
  background:rgba(15,23,42,0.6);
  border:1px solid rgba(148,163,184,0.4);
  box-shadow:var(--shadow-chip);
}
.pill.muted{
  background:rgba(148,163,184,0.08);
  border-color:rgba(148,163,184,0.25);
  color:var(--text-muted);
}
.pill .key{
  padding:2px 6px;
  border-radius:999px;
  background:rgba(15,23,42,0.85);
  font-weight:600;
  font-size:11px;
}

.status-banner{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:10px;
  padding:8px 10px;
  border-radius:var(--radius-lg);
  background:linear-gradient(90deg,rgba(14,165,233,0.12),rgba(14,165,233,0.03));
  border:1px solid rgba(56,189,248,0.2);
  box-shadow:var(--shadow-soft);
}
.status-item{
  display:flex;
  flex-direction:column;
  gap:2px;
}
.status-label{
  font-size:11px;
  letter-spacing:0.02em;
  color:var(--text-muted);
  text-transform:uppercase;
}
.status-value{
  font-size:13px;
  font-weight:600;
}

section{
  display:none;
}
section.active{
  display:block;
}

/* Cartes */
.card{
  background:radial-gradient(circle at top left,rgba(15,23,42,0.96),rgba(15,23,42,0.98));
  border-radius:var(--radius-lg);
  border:1px solid var(--border-subtle);
  box-shadow:var(--shadow-soft);
  padding:var(--pad);
}
.card-header{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:8px;
  margin-bottom:10px;
}
.card-title{
  font-size:14px;
  font-weight:600;
}
.card-sub{
  font-size:11px;
  color:var(--text-muted);
}
.section-card{
  margin-top:16px;
}

.auth-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
  gap:12px;
}
.auth-benefits ul{
  list-style:none;
  margin:8px 0 0;
  padding:0;
  display:flex;
  flex-direction:column;
  gap:6px;
  font-size:12px;
}
.auth-benefits li span{
  display:inline-block;
  margin-right:6px;
  color:#22d3ee;
  font-weight:700;
}
.auth-benefits{
  background:linear-gradient(180deg,rgba(14,165,233,0.08),rgba(14,165,233,0.02));
  border:1px solid rgba(56,189,248,0.25);
}

/* Top bar */
.top-bar{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:12px;
  margin-bottom:12px;
}
.top-left{
  display:flex;
  flex-direction:column;
  gap:6px;
}
.project-bar{
  display:flex;
  flex-wrap:wrap;
  align-items:center;
  gap:8px;
}
.top-actions{
  display:flex;
  flex-wrap:wrap;
  gap:6px;
}

.insight-row{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:10px;
  margin-bottom:12px;
}
.insight-card{
  padding:12px;
  border-radius:var(--radius);
  border:1px solid rgba(148,163,184,0.25);
  background:linear-gradient(180deg,rgba(15,23,42,0.95),rgba(15,23,42,0.9));
  box-shadow:var(--shadow-soft);
}
.insight-card.budget-card{
  border-color:rgba(56,189,248,0.45);
  background:linear-gradient(180deg,rgba(14,165,233,0.14),rgba(15,23,42,0.94));
}
.insight-card.highlight{border-color:rgba(14,165,233,0.4);background:linear-gradient(180deg,rgba(14,165,233,0.1),rgba(15,23,42,0.92));}
.insight-card.danger-soft{border-color:rgba(249,115,115,0.35);background:linear-gradient(180deg,rgba(249,115,115,0.08),rgba(15,23,42,0.92));}
.insight-label{font-size:12px;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.02em;}
.insight-value{font-size:20px;font-weight:700;margin:4px 0;}
.insight-currency-stack{display:flex;flex-direction:column;gap:6px;}
.insight-sar-line{display:flex;align-items:center;flex-wrap:wrap;gap:6px;font-size:12px;color:var(--text-muted);}
.insight-sar-amount{font-weight:600;color:var(--text-main);} 
.sar-rate-pill{background:rgba(56,189,248,0.15);border:1px solid rgba(56,189,248,0.4);color:var(--text-main);} 
.pill-warning{background:rgba(248,113,113,0.18);border-color:rgba(248,113,113,0.35);color:#fecdd3;}
.insight-meta{font-size:11px;color:var(--text-muted);}

/* Grille principale */
.grid-main{
  display:grid;
  grid-template-columns:minmax(0,1.15fr) minmax(0,1fr);
  gap:16px;
}

/* Colonnes */
.col-left,.col-right{
  display:flex;
  flex-direction:column;
  gap:14px;
}

/* Champs & formulaires */
.field{
  display:flex;
  flex-direction:column;
  gap:4px;
  font-size:12px;
}
.field-row{
  display:grid;
  grid-template-columns:minmax(0,1fr) minmax(0,1fr);
  gap:10px;
  margin-bottom:10px;
}
label{
  font-size:11px;
  color:var(--text-muted);
}
input,select,textarea{
  border-radius:8px;
  border:1px solid rgba(148,163,184,0.5);
  background:rgba(15,23,42,0.85);
  color:var(--text-main);
  padding:7px 8px;
  font-size:12px;
}
textarea{ resize:vertical; min-height:70px; }
input:focus,select:focus,textarea:focus{
  outline:none;
  border-color:var(--accent);
  box-shadow:0 0 0 1px rgba(56,189,248,0.6);
}

/* Boutons */
.btn{
  border-radius:999px;
  padding:6px 12px;
  border:none;
  cursor:pointer;
  font-size:12px;
  display:inline-flex;
  align-items:center;
  gap:4px;
}
.btn-accent{
  background:linear-gradient(135deg,#0ea5e9,#0369a1);
  color:white;
  box-shadow:0 8px 18px rgba(8,47,73,0.7);
}
.btn-ghost{
  background:rgba(15,23,42,0.7);
  color:var(--text-main);
  border:1px solid rgba(148,163,184,0.5);
}
.btn-danger{
  background:var(--danger);
  color:#111827;
  border:none;
}
.btn-danger-soft{
  background:var(--danger-soft);
  color:#fecaca;
  border:1px solid rgba(248,113,113,0.5);
}

/* Chips */
.chip{
  border-radius:999px;
  padding:3px 9px;
  font-size:11px;
  border:1px solid rgba(148,163,184,0.5);
  background:rgba(15,23,42,0.9);
}
.chip-accent{
  border-color:rgba(56,189,248,0.7);
  background:var(--accent-soft);
  color:#e0f2fe;
}
.chip-danger{
  border-color:rgba(248,113,113,0.8);
  background:var(--danger-soft);
  color:#fecaca;
}

/* Onglets */
.tabs{
  display:inline-flex;
  border-radius:999px;
  background:rgba(15,23,42,0.9);
  border:1px solid rgba(148,163,184,0.35);
  padding:2px;
  margin-bottom:10px;
}
.tab{
  flex:1;
  border-radius:999px;
  border:none;
  padding:5px 10px;
  font-size:11px;
  cursor:pointer;
  background:transparent;
  color:var(--text-muted);
}
.tab.active{
  background:rgba(15,23,42,1);
  color:var(--text-main);
  box-shadow:0 0 0 1px rgba(56,189,248,0.4);
}
.tab-panel{
  margin-top:6px;
}

.hidden{
  display:none !important;
}

/* Listes */
.list{
  margin-top:8px;
  border-radius:var(--radius);
  border:1px solid rgba(148,163,184,0.35);
  background:rgba(15,23,42,0.7);
  max-height:260px;
  overflow:auto;
}
.item-row{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:8px;
  padding:7px 9px;
  border-bottom:1px solid rgba(31,41,55,0.9);
  font-size:12px;
}
.item-row:last-child{
  border-bottom:none;
}
.item-title{
  font-weight:500;
  font-size:12px;
}
.item-meta{
  font-size:11px;
  color:var(--text-muted);
}
.item-actions{
  display:flex;
  flex-direction:column;
  align-items:flex-end;
  gap:4px;
}

/* Stats */
.stats-row{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
  gap:8px;
  margin-top:10px;
}
.stat{
  border-radius:12px;
  background:rgba(15,23,42,0.95);
  border:1px solid rgba(148,163,184,0.4);
  padding:6px 8px;
}
.stat-label{
  font-size:11px;
  color:var(--text-muted);
}
.stat-value{
  font-size:13px;
  font-weight:600;
  margin-top:3px;
}
.stat-note{
  font-size:11px;
  color:var(--text-muted);
  margin-top:4px;
}

/* Historique et tableaux */
.history-list{
  max-height:260px;
}
.transactions-table{
  width:100%;
  border-collapse:collapse;
  font-size:11px;
}
.transactions-table thead{
  position:sticky;
  top:0;
  background:rgba(15,23,42,0.96);
  z-index:1;
}
.transactions-table th,
.transactions-table td{
  padding:5px 6px;
  border-bottom:1px solid var(--table-border);
}
.transactions-table th{
  text-align:left;
  font-weight:500;
  color:var(--text-muted);
}
.transactions-table td.amount{
  text-align:right;
}

.imprevus-toolbar{
  display:flex;
  align-items:center;
  gap:8px;
  margin-top:10px;
}

.imprevus-panel{
  margin-top:8px;
  padding:10px;
  border-radius:10px;
  background:rgba(15,23,42,0.7);
  border:1px solid var(--border-color);
}

.imprevus-list{
  display:flex;
  flex-direction:column;
  gap:8px;
}

.imprevu-item{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  padding:8px;
  border-radius:8px;
  background:rgba(255,255,255,0.02);
  border:1px solid var(--table-border);
}

.imprevu-meta{
  font-size:11px;
  color:var(--text-muted);
}

.imprevu-amount{
  font-weight:700;
}

.imprevu-empty{
  font-size:11px;
  color:var(--text-muted);
}

/* Filtres */
.filters-grid{
  display:grid;
  grid-template-columns:repeat(6,minmax(0,1fr));
  gap:8px;
  margin-bottom:8px;
  font-size:11px;
}
.filters-grid > div{
  display:flex;
  flex-direction:column;
  gap:3px;
}
.filter-actions{
  align-self:flex-end;
}

/* Auth */
.auth-layout{
  max-width:380px;
  margin:40px auto 0;
}
.auth-actions{
  margin-top:10px;
  display:flex;
  flex-direction:column;
  gap:6px;
}
.auth-toggle{
  font-size:11px;
  color:var(--text-muted);
}
.auth-toggle button{
  background:none;
  border:none;
  color:var(--accent);
  font-size:11px;
  cursor:pointer;
  padding:0;
}
.password-field{
  display:flex;
  flex-direction:column;
  gap:4px;
}
.password-wrapper{
  display:flex;
  align-items:center;
  gap:6px;
}
.password-wrapper input{
  flex:1;
}
.password-toggle{
  padding:8px 10px;
  font-size:11px;
}
.password-toggle:disabled{
  opacity:0.5;
  cursor:not-allowed;
}
.role-pill{
  margin-left:6px;
  padding:3px 6px;
  border-radius:6px;
  background:rgba(59,130,246,0.12);
  color:var(--accent);
  font-size:11px;
}
.role-visitor .role-pill{
  background:rgba(248,113,113,0.12);
  color:var(--danger);
}

[data-requires-admin]:disabled{
  opacity:0.5;
  cursor:not-allowed;
}

/* Hints */
.hint{
  font-size:11px;
  color:var(--text-muted);
}

/* Settings */
.settings-grid{
  display:grid;
  grid-template-columns:minmax(0,1.05fr) minmax(0,1fr);
  gap:14px;
}
.settings-section{
  margin-top:8px;
  padding-top:8px;
  border-top:1px solid rgba(148,163,184,0.4);
}
.settings-section h3{
  margin:0 0 6px;
  font-size:12px;
}
.settings-row{
  display:flex;
  flex-direction:column;
  gap:8px;
}
.settings-col{
  display:flex;
  flex-direction:column;
  gap:6px;
}
.label-inline{
  font-size:11px;
  color:var(--text-muted);
}
.settings-username{
  font-size:13px;
  font-weight:600;
}
.avatar-wrapper{
  display:flex;
  align-items:center;
  gap:10px;
}
.avatar-preview{
  width:38px;
  height:38px;
  border-radius:999px;
  background:#020617;
  border:1px solid rgba(148,163,184,0.6);
  background-size:cover;
  background-position:center;
}
.theme-toggle{
  display:flex;
  align-items:center;
  gap:8px;
}
.settings-chantiers-list{
  max-height:230px;
  overflow:auto;
}
.chantier-item{
  padding:7px 9px;
  border-bottom:1px solid rgba(31,41,55,0.9);
  font-size:12px;
  display:flex;
  flex-direction:column;
  gap:4px;
}
.chantier-item:last-child{
  border-bottom:none;
}
.chantier-name{
  font-weight:500;
}
.chantier-meta{
  font-size:11px;
  color:var(--text-muted);
}
.chantier-tags{
  display:flex;
  flex-wrap:wrap;
  gap:4px;
  margin-top:2px;
}
.settings-chantiers-actions{
  margin-top:6px;
  display:flex;
  flex-wrap:wrap;
  gap:6px;
}

/* Logs */
.settings-logs h3{
  margin:0 0 6px;
  font-size:12px;
}
.logs-list{
  max-height:180px;
  overflow:auto;
}
.log-item{
  padding:6px 8px;
  border-bottom:1px solid rgba(31,41,55,0.9);
  font-size:11px;
}
.log-item:last-child{
  border-bottom:none;
}
.log-meta{
  margin-top:2px;
  color:var(--text-muted);
  font-size:10px;
}

/* Inventaire */
.inventory-grid{
  display:grid;
  grid-template-columns:minmax(0,1fr) minmax(0,1fr);
  gap:18px;
  margin-top:12px;
}
.inventory-table .inv-section-row td{
  font-weight:600;
  padding-top:8px;
  font-size:11px;
  color:var(--text-muted);
}

/* Divers */
.filter-row{
  margin-top:6px;
  display:flex;
  align-items:center;
  gap:8px;
  font-size:11px;
}

.settings-export-actions{
  display:flex;
  flex-wrap:wrap;
  gap:6px;
  margin-top:4px;
}

@media(max-width:960px){
  .grid-main{
    grid-template-columns:1fr;
  }
  .settings-grid{
    grid-template-columns:1fr;
  }
  .stats-row{
    grid-template-columns:repeat(2,minmax(0,1fr));
  }
  .filters-grid{
    grid-template-columns:repeat(2,minmax(0,1fr));
  }
}
@media(max-width:640px){
  header{
    flex-direction:column;
    align-items:flex-start;
    gap:8px;
  }
  .top-bar{
    flex-direction:column;
  }
  .stats-row{
    grid-template-columns:1fr;
  }
  .inventory-grid{
    grid-template-columns:1fr;
  }
}
